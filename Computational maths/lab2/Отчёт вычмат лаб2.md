---
tags:
  - uni
---
Министерство науки и высшего образования Российской Федерации
Федеральное государственное автономное образовательное учреждение
высшего образования
«Национальный исследовательский университет ИТМО»

Факультет программной инженерии и компьютерной техники

Лабораторная работа №2
по дисциплине

«Вычислительная математика»

Вариант №7

Выполнил: Студент группы P3213
Молчанов Фёдор Денисович

Проверила: Машина Е.А.

г. Санкт-Петербург

2025 г.
- - - 

Вариант 7
Методы в программе: 2, 4, 5, 6

# 1 Вычислительная реализация задачи

Нелинейное уравнение для вычислительной реализации:
$$
x^3 + 2,28x^2 - 1,934x - 3,907
$$
## 1 Часть. Решение нелинейного уравнения
### 1. Графическое определение корней
![[Pasted image 20250316231915.png]]
### 2. Определение интервалов изоляции корней и точнение корней нелинейного уравнения
Найдем приближенные интервалы изоляции корней, используя метод проверки знаков на концах интервалов. Вычислим значения функции в нескольких произвольных точках:

$f(-3) = -4.585$
$f(-2) = 1.081$
$f(1) = -2.561$
$f(2) = 9.345$

Знаки функции меняются в интервалах (-3, -2), (-2,1) и (1,2) следовательно, корни уравнения находятся в этих интервалах.

Уточнение корней с $\varepsilon = 10^{-2}$:
$$
\begin{cases}
x_{1} \approx -2,40 \\
x_{2} \approx -1,21 \\
x_{3} \approx 1,34
\end{cases}
$$
- - -
### 3. Вычисления с помощью методов
Методы для вычисления:
метод простой итерации (крайныий левый корень)
метод Ньютона (центральный корень) 
метод половинного сечения (крайний правый корень)
#### Метод простой итерации
##### Пробуем через $\varphi(x)$
Для применения метода простой итерации преобразуем его к виду:
$x = \varphi(x)$
Один из возможных способов:
$x = \sqrt[3]{3.907 + 1.934x - 2.28x^2}$
т.к. при подсчете $\phi(x)$ при $x_{0}=-3$ мы выходим за рамки рациональных чисел, то пробуем метод с использованием параметра $\lambda$. 
##### Решение через $\lambda$
$\lambda f(x) = 0$
$x = x + \lambda f(x)$
Определим итерационную функцию
$\varphi(x) = x + \lambda f(x)$  
$\varphi'(x) = 1 + \lambda f'(x)$

###### Условие сходимости
Высокая скорость сходимости достигается при $q = \max\limits_{[a,b]} |\varphi'(x)| \approx 0$.
Выбор $\lambda$:
- Если $f'(x) > 0$ на $[a, b]$, то $\lambda = -\frac{1}{\max\limits_{[a,b]} |f'(x)|}$
- Если $f'(x) < 0$ на $[a, b]$, то $\lambda = \frac{1}{\max\limits_{[a,b]} |f'(x)|}$
##### Применяем:
Для отрезка $[-3, -2]$:
- $f'(-3) \approx 11.386$
- $f'(-2) \approx 0.946$
- Значит, $\max |f'(x)| \approx 11.386$
- Тогда: $\lambda \approx -\frac{1}{11.386} \approx -0.088$

Для ускоренной сходимости выбрано: $\lambda = 0.2$

Формула: $x_{k+1} = x_k + \lambda f(x_k)$  

| № итерации | $x_{k}$  | $x_{k+1}$ | $f(x_{k+1})$ | $\|x_{k+1} - x_{k}\|$ |
| ---------- | -------- | --------- | ------------ | --------------------- |
| 1          | -3.00000 | -2.08300  | 0.97628      | 0.91700               |
| 2          | -2.08300 | -2.27826  | 0.50820      | 0.19526               |
| 3          | -2.27826 | -2.37990  | 0.12992      | 0.10164               |
| 4          | -2.37990 | -2.40588  | 0.01735      | 0.02598               |
| 5          | -2.40588 | -2.40935  | 0.00181      | 0.00347               |

$|x_n - x_{n-1}| \leq \varepsilon$ → останавливаем процесс

$x_1 \approx -2.4, \varepsilon = 0.01$
- - -
#### Метод Ньютона
Формулы: 
$x_{k+1} = x_k - \frac{f(x_k)}{f'(x_k)}$
Первая производная:  
$f'(x) = 3x^2 + 4.56x - 1.934$

| № итерации | $x_{k}$ | $f(x_{k})$ | $f^{\prime}(x_{k})$ | $x_{k+1}$ | $\|x_{k+1} - x_{k}\|$ |
| :--------: | :-----: | :--------: | :-----------------: | :-------: | :-------------------: |
|     1      | -1.0000 |   -0.693   |       -3.494        |  -1.1983  |        0.1983         |
|     2      | -1.1983 |  -0.0361   |       -3.0904       |  -1.2100  |        0.0117         |
|     3      | -1.2100 |  -0.00018  |       -3.0592       |  -1.2101  |       0.000059        |

 $x_2 \approx -1.21, \varepsilon = 0.01$
---
#### Метод половинного деления

| № шага | $a$   | $b$   | $x$   | $f(a)$ | $f(b)$ | $f(x)$ | $\|a-b\|$ |
| ------ | ----- | ----- | ----- | ------ | ------ | ------ | --------- |
| 1      | 1.0   | 2.0   | 1.5   | -2.561 | 9.345  | 0.703  | 1.000     |
| 2      | 1.0   | 1.5   | 1.25  | -2.561 | 0.703  | -0.855 | 0.500     |
| 3      | 1.25  | 1.5   | 1.375 | -0.855 | 0.703  | -0.099 | 0.250     |
| 4      | 1.375 | 1.5   | 1.437 | -0.099 | 0.703  | 0.308  | 0.125     |
| 5      | 1.375 | 1.437 | 1.406 | -0.099 | 0.308  | 0.103  | 0.062     |
| 6      | 1.375 | 1.406 | 1.390 | -0.099 | 0.103  | 0.001  | 0.031     |
| 7      | 1.375 | 1.390 | 1.382 | -0.099 | 0.001  | -0.049 | 0.015     |
| 8      | 1.382 | 1.390 | 1.386 | -0.049 | 0.001  | -0.024 | 0.008     |
$x_3 \approx 1.386$, $\varepsilon = 0.01$
- - -
### **Вывод:**  
Уточнённые корни уравнения:  
- $x_1 \approx -2.4$
- $x_2 \approx -2.4$
- $x_3 \approx 1.3$

## 2 часть. Решение системы нелинейных уравнений
Система
$$
\begin{cases}
2x - \sin(y-0.5) = 1 \\
y + \cos x=1.5
\end{cases}
$$
Решить методом простой итерации
### Графическое решение 
![[initial.png]]
### Решение методом простой итерации
Преобразуем систему к эквивалентной форме:

$$
\begin{cases}
x = \frac{1 + \sin(y - 0.5)}{2} \\
y = 1.5 - \cos x
\end{cases}
$$

Итерации будут проходить до достижения следующих условий (должны быть выполнены оба условия):
$$
|x^{(k+1)}-x^{(k)}| < \varepsilon,\quad |y^{(k+1)}- y^{(k)}| < \varepsilon
$$
Выбираем начальное приближение:  
$x^{(0)} = 0.5, \quad y^{(0)} = 1$

---

##### 1 шаг.
$$
x^{(1)} = \frac{1 + \sin(1 - 0.5)}{2} = 0.7397 \\
y^{(1)} = 1.5 - \cos(0.5) = 0.6224
$$

$$
|x^{(1)} - x^{(0)}| = 0.2397 > \varepsilon \\
|y^{(1)} - y^{(0)}| = 0.3776 > \varepsilon
$$

##### 2 шаг.
$$
x^{(2)} = \frac{1 + \sin(0.6224 - 0.5)}{2} = 0.5610 \\
y^{(2)} = 1.5 - \cos(0.7397) = 0.7604
$$

$$
|x^{(2)} - x^{(1)}| = 0.1787 > \varepsilon \\
|y^{(2)} - y^{(1)}| = 0.1380 > \varepsilon
$$

##### 3 шаг.
$$
x^{(3)} = \frac{1 + \sin(0.7604 - 0.5)}{2} = 0.6288 \\
y^{(3)} = 1.5 - \cos(0.5610) = 0.6523
$$

$$
|x^{(3)} - x^{(2)}| = 0.0678 > \varepsilon \\
|y^{(3)} - y^{(2)}| = 0.1081 > \varepsilon
$$

##### 4 шаг.
$$
x^{(4)} = \frac{1 + \sin(0.6523 - 0.5)}{2} = 0.5758 \\
y^{(4)} = 1.5 - \cos(0.6288) = 0.6906
$$

$$
|x^{(4)} - x^{(3)}| = 0.0530 > \varepsilon \\
|y^{(4)} - y^{(3)}| = 0.0383 > \varepsilon
$$

##### 5 шаг.
$$
x^{(5)} = \frac{1 + \sin(0.6906 - 0.5)}{2} = 0.5948 \\
y^{(5)} = 1.5 - \cos(0.5758) = 0.6627
$$

$$
|x^{(5)} - x^{(4)}| = 0.0190 > \varepsilon \\
|y^{(5)} - y^{(4)}| = 0.0279 > \varepsilon
$$

##### 6 шаг.
$$
x^{(6)} = \frac{1 + \sin(0.6627 - 0.5)}{2} = 0.5810 \\
y^{(6)} = 1.5 - \cos(0.5948) = 0.6737
$$

$$
|x^{(6)} - x^{(5)}| = 0.0138 > \varepsilon \\
|y^{(6)} - y^{(5)}| = 0.0110 > \varepsilon
$$

##### 7 шаг.
$$
x^{(7)} = \frac{1 + \sin(0.6737 - 0.5)}{2} = 0.5864 \\
y^{(7)} = 1.5 - \cos(0.5810) = 0.6677
$$

$$
|x^{(7)} - x^{(6)}| = 0.0054 < \varepsilon \\
|y^{(7)} - y^{(6)}| = 0.0060 < \varepsilon
$$
---

##### Ответ:
Метод простой итерации сошелся за 7 шагов.  
Приближенное решение с точностью $\varepsilon = 0.01$:

$$
x \approx 0.5864, \quad y \approx 0.6677
$$
# 2 Программная реализация задачи
Методы в программе:
**Решение нелинейных уравнений:**
- 2 - Метод Хорд
- 4 - Метод Секущих
- 5 - Метод простой итерации
**Решение систем нелинейных уравнений:**
* 6 - Метод Ньютона

### Сниппеты функций
##### Метод Хорд
```python
def chord_method(f, a, b, eps, max_iter=10000):
	iter_count = 0
	x = a - (b - a) * f(a) / (f(b) - f(a))
	
	while abs(b - a) > eps and iter_count < max_iter:
		if f(a) * f(x) < 0:
			b = x
		else:
			a = x
	
	x = a - (b - a) * f(a) / (f(b) - f(a))
	iter_count += 1
	x_root = x
	
return {
	"method": "Метод хорд",
	"a": a,
	"b": b,
	"epsilon":eps,
	"root": x_root,
	"f(root)": f(x_root),
	"iterations": iter_count
}
```

##### Метод Секущих
```python
def secant_method(f, a, b, eps, max_iter=10000):
	x0, x1 = a, b
	iter_count = 0

	while abs(x1 - x0) > eps and iter_count < max_iter:
	
		try:
		
			x2 = x1 - f(x1) * (x1 - x0) / (f(x1) - f(x0))
		
		except ZeroDivisionError:
		
			break
		
		x0, x1 = x1, x2
		
		iter_count += 1

return {

	"method": "Метод секущих",
	
	"root": x1,
	
	"f(root)": f(x1),
	
	"iterations": iter_count
}
```

##### Метод простых итераций
```python
def simple_iteration_method(f, a, b, eps, max_iter=1000):

	lambda_ = -1.0 / max(abs(f(a)), abs(f(b)))
	
	phi = lambda x: x + lambda_ * f(x)

	x_prev = a
	
	x_curr = phi(x_prev)
	
	iter_count = 1
	
	  
	
	while abs(x_curr - x_prev) > eps and iter_count < max_iter:
	
		x_prev = x_curr
		
		x_curr = phi(x_prev)
		
		iter_count += 1
	
	  

return {

	"method": "Метод простой итерации",
	
	"root": x_curr,
	
	"f(root)": f(x_curr),
	
	"iterations": iter_count
}
```

##### Метод простых итераций
```python
def newton_system(F, J, x0, eps=1e-6, max_iter=100):
	
	x = np.array(x0, dtype=float)
	iter_count = 0
	errors = []

	while iter_count < max_iter:
		
		Fx = np.array(F(x))
		Jx = np.array(J(x))
		norm_F = np.linalg.norm(Fx)
		
		if norm_F < eps:
			break
		
		try:
			dx = np.linalg.solve(Jx, -Fx)
			
		except np.linalg.LinAlgError:
			
			print("Якобиан необратим.")
			
			break
			
		x_new = x + dx
		error = np.linalg.norm(dx)
		errors.append(error)

		if error < eps:
		
			x = x_new
		
			break
	
		x = x_new
		iter_count += 1

return {

	"x": x.tolist(),
	
	"iterations": iter_count,
	
	"errors": errors,
	
	"residual": np.linalg.norm(F(x))

}
```
### Графики функций из программы
$$
x^3 - x - 2
$$
![[1.png]]
$$
\cos(x) - x
$$
![[2.png]]
$$
\exp(x) - 2
$$
![[3.png]]
$$
x^2-2
$$
(правый корень)
![[4.png]]
$$
\sin(x) - 0.5
$$
asd
![[5.png]]
график первой системы
![[system_1.png]]
график второй системы
![[system_2.png]]

график третьей системы

![[system_3.png]]